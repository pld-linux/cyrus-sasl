--- cyrus-sasl-2.1.26/plugins/gssapi.c.orig	2012-11-23 19:03:06.002027748 +0100
+++ cyrus-sasl-2.1.26/plugins/gssapi.c	2012-11-23 19:06:07.818690625 +0100
@@ -379,7 +379,7 @@
     }
     
     if (output_token->value && output) {
-	unsigned char * p;
+	int len;
 	
 	ret = _plug_buf_alloc(text->utils,
 			      &(text->encode_buf),
@@ -393,13 +393,8 @@
 	    return ret;
 	}
 
-	p = (unsigned char *) text->encode_buf;
-	
-	p[0] = (output_token->length>>24) & 0xFF;
-	p[1] = (output_token->length>>16) & 0xFF;
-	p[2] = (output_token->length>>8) & 0xFF;
-	p[3] = output_token->length & 0xFF;
-
+	len = htonl(output_token->length);
+	memcpy(text->encode_buf, &len, 4);
 	memcpy(text->encode_buf + 4, output_token->value, output_token->length);
     }
     
